<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://autoit-gui-skeleton.github.io///assets/css/main.css" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="https://autoit-gui-skeleton.github.io///assets/img/favicon.ico" type="image/x-icon" />

    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="AutoIt GUI Skeleton" href="https://autoit-gui-skeleton.github.io///fr//feed.xml" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous" />

    <!-- Google Fonts -->
    
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css" />
    

    <!-- KaTeX 0.8.3 -->
    
    <link rel="stylesheet" type="text/css" href="https://autoit-gui-skeleton.github.io///assets/css/vendor/katex.min.css" />
    

    <!-- FancyBox style -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.css" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous" />

    <!-- Prism CSS syntax highlighter for AutoIt support -->
    <link rel="stylesheet" type="text/css" href="https://autoit-gui-skeleton.github.io///assets/css/vendor/prism.css" />

    <!-- Flags sprites -->
    <link rel="stylesheet" type="text/css" href="https://autoit-gui-skeleton.github.io///assets/flag-icon-css-master/css/flag-icon.min.css" />

    <!-- seo tags -->
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Calculer la taille requise par une chaîne de caractères pour l’inserer dans un label avec AGS-wrapper-string-size" />
<meta property="og:locale" content="fr" />
<meta name="description" content="Pour calculer la taille ; largeur et hauteur ; requise par une chaine de caractères, AGS fournit le wrapper @autoit-gui-skeleton/ags-wrapper-string-size de la librairie StringSize.au3" />
<meta property="og:description" content="Pour calculer la taille ; largeur et hauteur ; requise par une chaine de caractères, AGS fournit le wrapper @autoit-gui-skeleton/ags-wrapper-string-size de la librairie StringSize.au3" />
<link rel="canonical" href="https://autoit-gui-skeleton.github.io//2021/11/22/ags_wrapper_string_size.html" />
<meta property="og:url" content="https://autoit-gui-skeleton.github.io//2021/11/22/ags_wrapper_string_size.html" />
<meta property="og:site_name" content="AutoIt GUI Skeleton" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-22T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Calculer la taille requise par une chaîne de caractères pour l’inserer dans un label avec AGS-wrapper-string-size" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Calculer la taille requise par une chaîne de caractères pour l’inserer dans un label avec AGS-wrapper-string-size","dateModified":"2021-11-22T00:00:00+01:00","datePublished":"2021-11-22T00:00:00+01:00","url":"https://autoit-gui-skeleton.github.io//2021/11/22/ags_wrapper_string_size.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://autoit-gui-skeleton.github.io//2021/11/22/ags_wrapper_string_size.html"},"description":"Pour calculer la taille ; largeur et hauteur ; requise par une chaine de caractères, AGS fournit le wrapper @autoit-gui-skeleton/ags-wrapper-string-size de la librairie StringSize.au3","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <title>AutoIt GUI Skeleton</title>
</head>

  <body>
    <header class="site-header">

    <!-- Logo and title -->
	<div class="branding">
		<a href="https://autoit-gui-skeleton.github.io//fr/">
			<img class="avatar" src="https://autoit-gui-skeleton.github.io//assets/img/autoit.png" alt=""/>
		</a>

		<p class="site-title">
			<a href="https://autoit-gui-skeleton.github.io//fr/">AutoIt Gui Skeleton</a>
		</p>
	</div>

    <!-- This finds the current page so it can be highlighted. -->
    

    <nav class="clear">

        <!-- Toggle menu -->
        <a id="pull" class="toggle">
            <i class="fa fa-bars fa-lg"></i>
        </a>

        <!-- Menu -->
        <ul class="hide toggleMenu">

            
              <li><a href="https://autoit-gui-skeleton.github.io//fr/documentation">Documentation</a></li>
              <li><a href="https://autoit-gui-skeleton.github.io//fr/articles">Articles</a></li>
              <li><a href="https://autoit-gui-skeleton.github.io//fr/about">À propos</a></li>
            

            <li class="separator"> | </li>

            
            
            <li>
                <a class="clear" href="https://autoit-gui-skeleton.github.io//fr/search">
                    <i class="fa fa-search" aria-hidden="true"></i>
                </a>
            </li>
            
            
            
            <li>
                <a class="clear" href="https://autoit-gui-skeleton.github.io//fr/tags">
                    <i class="fa fa-tags" aria-hidden="true"></i>
                </a>
            </li>
            
            

            
            <li>
                <a class="link-en" href="https://autoit-gui-skeleton.github.io///2021/11/22/ags_wrapper_string_size.html">
                    <span class="flag-icon flag-icon-gb" title="Translate in english" alt="Anglais"></span>
                    <!-- <span class="flag-icon flag-icon-gb" data-toggle="tooltip" data-placement="bottom" title="Translate in english" alt="Anglais"></span> -->
                </a>
            </li>
            
        </ul>
    </nav>
</header>

    <div class="content">
      <article class="feature-image" >
    <header id="main"
            class="call-out"
            style="background-image: url('https://autoit-gui-skeleton.github.io//assets/img/pixabay/ags-wrapper.jpg')">
        <h1 id="Calculer+la+taille+requise+par+une+cha%C3%AEne+de+caract%C3%A8res+pour+l%27inserer+dans+un+label+avec+%3Cb%3EAGS-wrapper-string-size%3C%2Fb%3E" class="title">Calculer la taille requise par une chaîne de caractères pour l'inserer dans un label avec <b>AGS-wrapper-string-size</b></h1>

        
            <p class="date">
        
        November 22, 2021 </p>
    </header>

    <section class="post-content"><blockquote>
  <p>Pour calculer la taille ; largeur et hauteur ; requise par une chaine de caractères, AGS fournit le <em>wrapper</em> <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-wrapper-string-size">@autoit-gui-skeleton/ags-wrapper-string-size</a> de la librairie <a href="https://www.autoitscript.com/forum/topic/114034-stringsize-m23-new-version-16-aug-11/">StringSize.au3</a></p>
</blockquote>

<!--more-->

<h1 id="comment-installer-ags-wrapper-string-size-">Comment installer AGS-wrapper-string-size ?</h1>

<p>On suppose que vous avez déjà installé <a href="https://nodejs.org/">Node.js</a> et <a href="https://yarnpkg.com/lang/en/">Yarn</a>, par example avec <a href="https://chocolatey.org/">Chocolatey</a>, et pour installer le package AGS-wrapper-json, vous pouvez alors utiliser le gestionnaire de dépendances pour AutoIt fournit dans AGS. Il suffit donc de taper dans le dossier racine du projet, où le fichier <code class="language-plaintext highlighter-rouge">package.json</code> est stocké:</p>

<pre class="command-line" data-prompt="C: \&gt;">
<code class=" language-bash">yarn add @autoit-gui-skeleton/ags-wrapper-string-size --modules-folder vendor</code>
</pre>

<p>Toutes les dépendances du projet, ainsi que les dépendances filles des dépedances parentes sont installées dans le répertoire <code class="language-plaintext highlighter-rouge">./vendor/@autoit-gui-skeleton/</code>. Pour l’utiliser dans son programme AutoIt, vous devez inclure cette bibliothèque avec l’instruction:</p>

<pre><code class="language-autoit">#include 'vendor/@autoit-gui-skeleton/ags-wrapper-string-size/StringSize.au3'
</code></pre>

<p>Tous les paquets AGS hébergés dans le dépôt npmjs appartiennent à l’organisation <a href="https://www.npmjs.com/search?q=autoit-gui-skeleton">@autoit-gui-skeleton organization</a>. En effet afin de simplifier la gestion des dépendances d’un projet AutoIt construit avec le framework AGS, nous avons détourné de son utilisation initiale le gestionnaire de dépendance npm, et son évolution Yarn. Cela nous permet de gérer les dépendances d’un projet AGS avec d’autres bibliothèques AutoIt, et de partager ces paquets AutoIt à partir du référentiel npmjs.org.</p>

<h1 id="stringsize">StringSize</h1>

<h2 id="introduction">Introduction</h2>

<p>La bibliothèque StringSize prend une chaîne de texte et calcule la taille de l’étiquette requise pour la contenir, ainsi que la mise en forme de la chaîne pour qu’elle s’adapte.</p>

<h2 id="exemples">Exemples</h2>

<h3 id="simple-usage">Simple usage</h3>

<pre><code class="language-autoit">Local $stringSize = _StringSize($text, $fontsize, $fontweight, $fontattribute, $fontfamily, $GUI_width - $marginLeftRight*2)

If(Not @error) Then
      $label_TEXT_reformated = $stringSize[0]
      $label_WIDTH_calculated = $stringSize[2] ; ($stringSize[2] / $dpi)
      $label_HEIGHT_calculated = $stringSize[3] ; ($stringSize[3] / $dpi)
    
      GUISetFont($fontsize, $fontweight, $fontattribute, $fontfamily)
      GUICtrlSetData($label_ID, $label_TEXT_reformated)
      GUICtrlSetPos($label_ID, $marginLeftRight, $top, $label_WIDTH_calculated, $label_HEIGHT_calculated)
EndIf
</code></pre>

<h3 id="reformaté-une-string-dans-un-label">Reformaté une string dans un label</h3>

<pre><code class="language-autoit">#include &lt;GUIConstantsEx.au3&gt;
#include "StringSize.au3"

$sText = " I am a very long line and I am not formatted in any way so that I will not fit within the width of the GUI that surrounds me!"

$hGUI = GUICreate("Test", 500, 500)

; A label with no width or height set
GUICtrlCreateLabel($sText, 10, 10)
GUICtrlSetBkColor(-1, 0xFF8080)

; A label with no height set
GUICtrlCreateLabel($sText, 10, 50, 200)
GUICtrlSetBkColor(-1, 0xC0C0FF)

; A label sized by StringSize
$aSize = _StringSize($sText, Default, Default, Default, "", 200)
GUICtrlCreateLabel($aSize[0], 10, 90, $aSize[2], $aSize[3])
GUICtrlSetBkColor(-1, 0x80FF80)

GUISetState()

While 1
    Switch GUIGetMsg()
        Case $GUI_EVENT_CLOSE
            Exit
    EndSwitch
WEnd
</code></pre>

<h3 id="calcul-de-la-plus-grande-taille-de-police-possible-pour-une-largeur-de-label-donné">Calcul de la plus grande taille de police possible pour une largeur de label donné</h3>

<pre><code class="language-autoit">#include &lt;GUIConstantsEx.au3&gt;

#include "StringSize.au3"

; Declare arrays to hold parameters
Global $aFont[4] = ["Arial", "Tahoma", "Courier New", "Comic Sans MS"]
Global $aWeight[4] = [200, 400, 600, 800]
Global $aAttrib[4] = [0, 2, 4, 0]
Global $aColour[4] = [0xFFFFD0, 0xD0FFD0, 0xD0D0FF, 0xFFD0FF]

$sText = "The UDF will calculate the largest possible font size which will allow this text to fit in the randomly sized label.  " &amp; _
    "Pressing the 'Increase' button will use the next size up so you can see how successful it was.  " &amp; @CRLF &amp; _
    "Note that the UDF is pessimistic and will leave small borders to the right and at the bottom of the text, so you might " &amp; _
    "be able to go one size up in a few cases, although this risks clipping the trailing edges of italic letters or the tails of letters such as 'g'."

$hGUI = GUICreate("Test", 500, 500, 100, 100)

$hButton_Next = GUICtrlCreateButton("Next", 10, 10, 80, 30)
GUICtrlSetResizing(-1, $GUI_DOCKALL)

$hLabel_Size = GUICtrlCreateLabel("", 100, 10, 40, 30)
GUICtrlSetResizing(-1, $GUI_DOCKALL)
GUICtrlSetFont(-1, 24)

$hButton_Increase = GUICtrlCreateButton("Increase", 150, 10, 80, 30)
GUICtrlSetResizing(-1, $GUI_DOCKALL)

GUISetState()

While 1

    ; Choose parameter values

    $iX = 10 * Random(25, 50, 1)
    $iY = 10 * Random(10, 40, 1)
    $sFont = $aFont[Random(0, 3, 1)]
    $iWeight = $aWeight[Random(0, 3, 1)]
    $iAttrib = $aAttrib[Random(0, 3, 1)]
    $iColour = $aColour[Random(0, 3, 1)]

    WinMove($hGUI, "", 100, 100, $iX + 26, $iY + 85)
    $hLabel = GUICtrlCreateLabel("", 10, 50, $iX, $iY)
    GUICtrlSetBkColor(-1, $iColour)

    For $iSize = 5 To 50
        $aSize = _StringSize($sText, $iSize, $iWeight, $iAttrib, $sFont, $iX)
    If $aSize[3] &gt; $iY Then
            $iSize -= 1
            ExitLoop
        EndIf
    Next

    GUICtrlSetData($hLabel_Size, $iSize)
    GUICtrlSetFont($hLabel, $iSize, $iWeight, $iAttrib, $sFont)
    $aSize = _StringSize($sText, $iSize, $iWeight, $iAttrib, $sFont, $iX)
    GUICtrlSetData($hLabel, $aSize[0])

    While 1
        Switch GUIGetMsg()
            Case $GUI_EVENT_CLOSE
                Exit
            Case $hButton_Next
                GUICtrlDelete($hLabel)
                GUICtrlSetData($hLabel_Size, "")
                ExitLoop
            Case $hButton_Increase
                GUICtrlSetData($hLabel, "")
                $iSize += 1
                GUICtrlSetData($hLabel_Size, $iSize)
                GUICtrlSetFont($hLabel, $iSize, $iWeight, $iAttrib, $sFont)
                $aSize = _StringSize($sText, $iSize, $iWeight, $iAttrib, $sFont, $iX)
                GUICtrlSetData($hLabel, $aSize[0])
        EndSwitch
    WEnd

WEnd
</code></pre>

<p><br /></p>

<blockquote>
  <p><strong>Continue reading ?</strong></p>

  <p><a href="https://autoit-gui-skeleton.github.io//fr/documentation/getting-started#dependencies-manager-for-autoit">Dependencies manager for AutoIt</a></p>
</blockquote>

</section>

    <!-- Social media shares -->
    <div class="share-buttons">
    <ul>
        
        <li>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html&quote=Calculer la taille requise par une chaîne de caractères pour l'inserer dans un label avec <b>AGS-wrapper-string-size</b>%20%7C%20AutoIt GUI Skeleton"
               target="_blank" title="Share on Facebook">
                <i class="fab fa-facebook-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on Facebook</span>
            </a>
        </li>
        

        
        <li>
            <a href="https://twitter.com/intent/tweet?source=https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html&text=Calculer la taille requise par une chaîne de caractères pour l'inserer dans un label avec <b>AGS-wrapper-string-size</b>%20%7C%20AutoIt GUI Skeleton:%20https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html"
               target="_blank" title="Tweet">
                <i class="fab fa-twitter-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Tweet</span>
            </a>
        </li>
        

        
        <li>
            <a href="https://plus.google.com/share?url=https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html"
               target="_blank" title="Share on Google+">
                <i class="fab fa-google-plus-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on Google+</span>
            </a>
        </li>
        

        

        
        <li>
            <a href="http://pinterest.com/pin/create/button/?url=https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html&description="
               target="_blank" title="Pin it">
                <i class="fab fa-pinterest-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Pin it</span>
            </a>
        </li>
        

        

        

        
        <li>
            <a href="http://www.linkedin.com/shareArticle?mini=true&url=https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html&title=Calculer la taille requise par une chaîne de caractères pour l'inserer dans un label avec <b>AGS-wrapper-string-size</b>%20%7C%20AutoIt GUI Skeleton&summary=&source=https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html"
               target="_blank" title="Share on LinkedIn">
                <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on LinkedIn</span>
            </a>
        </li>
        

        

        
        <li>
            <a href="mailto:?subject=Calculer la taille requise par une chaîne de caractères pour l'inserer dans un label avec <b>AGS-wrapper-string-size</b>%20%7C%20AutoIt GUI Skeleton&body=:%20https://autoit-gui-skeleton.github.io//fr/2021/11/22/ags_wrapper_string_size.html"
               target="_blank" title="Email">
                <i class="fa fa-envelope-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Email</span>
            </a>
        </li>
        
    </ul>
</div>

    <!-- Tag list -->
    
    



<div class="tag-list">
    
    <div class="meta">Tags</div>
    

    
    <a class="button" href="/fr/tags#AGS">
        <p><i class="fa fa-tag fa-fw"></i> AGS</p>
    </a>
    
    <a class="button" href="/fr/tags#Wrapper">
        <p><i class="fa fa-tag fa-fw"></i> Wrapper</p>
    </a>
    
</div>


</article>

<!-- Post navigation -->

<div id="post-nav" class="row post-nav">

    <div class="col-sm-12">
        <div id="previous-post" class="post-nav-post">
            
            <p class="uppercase">Previous post</p>
            <a href="/fr/2021/10/11/autoit-syntax-highlighting.html">
            <p>AutoIt coloration syntaxique dans Jetbrains</p>
            </a>
            
        </div>
    </div>

    <div class="col-sm-6">
        <div id="next-post" class="post-nav-post">
            
        </div>
    </div>
</div>


<!-- Disqus

-->
    </div>
    
<footer class="site-footer">
    <p class="text">Built with ♥ with <a href="https://jekyllrb.com/">Jekyll</a> and fork of <a href="https://github.com/sylhare/Type-on-Strap">Type on Strap</a>
</p>
            <div class="footer-icons">
                <ul>
                <!-- Social icons from Font Awesome, if enabled -->
                


<li><a href="mailto:vb20100bv@gmail.com" title="Email"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></a></li>














<li>
	<a href="https://github.com/v20100v" title="Follow on GitHub">
		<span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-github fa-stack-1x fa-inverse"></i>
        </span>
	</a>
</li>
































                </ul>
            </div>
</footer>




    <!-- KaTeX 0.8.3 -->

<link rel="stylesheet" type="text/css" href="https://autoit-gui-skeleton.github.io///assets/css/vendor/katex.min.css">
<script src="https://autoit-gui-skeleton.github.io///assets/js/vendor/katex.min.js"></script>


<!-- Google Analytics -->

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-119463892-1', 'auto');
    ga('send', 'pageview');
</script>


<!-- Jquery -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>

<!-- Bootstrap -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
        integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"></script>

<!-- Prism CSS syntax highlighter for AutoIt support -->
<script src="https://autoit-gui-skeleton.github.io///assets/js/vendor/prism.js"></script>

<!-- FancyBox -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.js"></script>

<script>
    $(document).ready(function () {
        // Enable fancybox evrywhere with this class selector
        $('.img-fancybox').each(function (index, value) {
            $(this).wrap('<a href="' + $(this).attr('src') + '" data-fancybox data-caption="' + $(this).attr('alt') + '">');
        });

        // Enable bootstrap tooltip everywhere with data-toogle attribute
        $('[data-toggle="tooltip"]').tooltip()
    });
</script>

<!-- Main JS (navbar.js, katex_init.js and masonry_init.js)-->
<script defer=true src="/assets/js/main.min.js"></script>
  </body>
</html>