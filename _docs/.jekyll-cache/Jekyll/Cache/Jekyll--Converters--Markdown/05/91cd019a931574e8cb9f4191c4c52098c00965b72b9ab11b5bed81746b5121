I"¯¢<!-- Breadcrumb navigation -->
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="https://autoit-gui-skeleton.github.io//fr/">Home</a></li>
    <li class="breadcrumb-item"><a href="https://autoit-gui-skeleton.github.io//fr/documentation">Documentation</a></li>
    <li class="breadcrumb-item active" aria-current="page">1. D√©marrer avec AGS</li>
  </ol>
</nav>

<!-- To be placed at the beginning of the post, it is where the table of content will be generated -->
<ul id="markdown-toc">
  <li><a href="#ags-" id="markdown-toc-ags-">AGS ?</a></li>
  <li><a href="#architecture-dun-projet-ags" id="markdown-toc-architecture-dun-projet-ags">Architecture d‚Äôun projet AGS</a>    <ul>
      <li><a href="#r√©pertoires-et-fichiers-dun-projet-ags" id="markdown-toc-r√©pertoires-et-fichiers-dun-projet-ags">R√©pertoires et fichiers d‚Äôun projet AGS</a>        <ul>
          <li><a href="#r√©pertoire-assets" id="markdown-toc-r√©pertoire-assets">R√©pertoire <code class="language-plaintext highlighter-rouge">assets</code></a></li>
          <li><a href="#r√©pertoire-bin" id="markdown-toc-r√©pertoire-bin">R√©pertoire <code class="language-plaintext highlighter-rouge">bin</code></a></li>
          <li><a href="#r√©pertoire-config" id="markdown-toc-r√©pertoire-config">R√©pertoire <code class="language-plaintext highlighter-rouge">config</code></a></li>
          <li><a href="#r√©pertoire-releases" id="markdown-toc-r√©pertoire-releases">R√©pertoire <code class="language-plaintext highlighter-rouge">releases</code></a></li>
          <li><a href="#r√©pertoire-src" id="markdown-toc-r√©pertoire-src">R√©pertoire <code class="language-plaintext highlighter-rouge">src</code></a></li>
          <li><a href="#r√©pertoire-vendor" id="markdown-toc-r√©pertoire-vendor">R√©pertoire <code class="language-plaintext highlighter-rouge">vendor</code></a></li>
        </ul>
      </li>
      <li><a href="#vue-densemble-de-larchitecture-dags" id="markdown-toc-vue-densemble-de-larchitecture-dags">Vue d‚Äôensemble de l‚Äôarchitecture d‚ÄôAGS</a>        <ul>
          <li><a href="#le-programme-dentr√©e-principal-myapplicationau3" id="markdown-toc-le-programme-dentr√©e-principal-myapplicationau3">Le programme d‚Äôentr√©e principal <code class="language-plaintext highlighter-rouge">MyApplication.au3</code></a></li>
          <li><a href="#le-gestionnaire-principal-de-linterface-graphique-guiau3" id="markdown-toc-le-gestionnaire-principal-de-linterface-graphique-guiau3">Le gestionnaire principal de l‚Äôinterface graphique <code class="language-plaintext highlighter-rouge">GUI.au3</code></a></li>
          <li><a href="#centralisez-la-d√©claration-des-variables-globales-avec-globalsau3" id="markdown-toc-centralisez-la-d√©claration-des-variables-globales-avec-globalsau3">Centralisez la d√©claration des variables globales avec <code class="language-plaintext highlighter-rouge">GLOBALS.au3</code></a></li>
          <li><a href="#le-gestionnaire-principal-des-services-servicesau3" id="markdown-toc-le-gestionnaire-principal-des-services-servicesau3">Le gestionnaire principal des services <code class="language-plaintext highlighter-rouge">SERVICES.au3</code></a></li>
          <li><a href="#d√©ploiement-facile-avec-g√©n√©ration-dun-installateur-windows" id="markdown-toc-d√©ploiement-facile-avec-g√©n√©ration-dun-installateur-windows">D√©ploiement facile avec g√©n√©ration d‚Äôun installateur Windows</a></li>
        </ul>
      </li>
      <li><a href="#gestion-de-d√©pendances-pour-autoit" id="markdown-toc-gestion-de-d√©pendances-pour-autoit">Gestion de d√©pendances pour AutoIt</a>        <ul>
          <li><a href="#ags-component-and-ags-wrapper" id="markdown-toc-ags-component-and-ags-wrapper">AGS-component and AGS-Wrapper</a></li>
          <li><a href="#d√©crire-un-projet-ags-et-ses-d√©pendances" id="markdown-toc-d√©crire-un-projet-ags-et-ses-d√©pendances">D√©crire un projet AGS et ses d√©pendances</a></li>
        </ul>
      </li>
      <li><a href="#g√©rer-les-versions-de-lapplication" id="markdown-toc-g√©rer-les-versions-de-lapplication">G√©rer les versions de l‚Äôapplication</a>        <ul>
          <li><a href="#contr√¥le-de-versions-avec-git" id="markdown-toc-contr√¥le-de-versions-avec-git">Contr√¥le de versions avec Git</a></li>
          <li><a href="#v√©rifier-les-mises-√†-jours-de-lapplication" id="markdown-toc-v√©rifier-les-mises-√†-jours-de-lapplication">V√©rifier les mises √† jours de l‚Äôapplication</a></li>
        </ul>
      </li>
      <li><a href="#configurer-le-projet-ags" id="markdown-toc-configurer-le-projet-ags">Configurer le projet AGS</a>        <ul>
          <li><a href="#cr√©er-un-fichier-de-configuration" id="markdown-toc-cr√©er-un-fichier-de-configuration">Cr√©er un fichier de configuration</a></li>
          <li><a href="#constantes-et-variables-globales" id="markdown-toc-constantes-et-variables-globales">Constantes et variables globales</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="ags-">AGS ?</h1>

<p>AutoIt Gui Skeleton (AGS) offre un environnement pour les d√©veloppeurs, facilitant la cr√©ation d‚Äôapplications AutoIt. AGS propose d‚Äôutiliser des conventions et une architecture standardis√©. Il donne √©galement des outils pour aider les d√©veloppeurs dans les t√¢ches r√©currentes propre √† l‚Äôing√©nierie logicielle.</p>

<h1 id="architecture-dun-projet-ags">Architecture d‚Äôun projet AGS</h1>

<p>Un projet AGS respecte cette organisation pour ses fichiers et r√©pertoires:</p>

<pre>
<code class="language-markup">Project root folder
.
|   .gitignore                 # Specifies untracked files to ignore in AGS project
|   .yarnrc                    # Yarn configuration used in handling AutoIt dependencies 
|   MyApplication.au3          # The main entry progam. 
|   package.json               # Use npm's convention to describe this project
|   README.md                  # In human readable.
|   RELEASES.json              # Repository for all releases notes of this application.
|      
+---assets                     # Applications assets (images, pdf, static files...) 
|   
+---bin                        # Binary tools
|              
+---config                     # Configuration of application.
|       parameters.ini         # Parameters which can be modified by user in application
|       parameters.ini.dist    # Template of parameters.ini which is save in  control version
|              
+---releases                   # Releases application (zip and windows setup)
|          
+---src                        # AutoIt source
|   |   BUSINESS.au3           # Entry point for business and logic code
|   |   GLOBALS.au3            # Entry point for constants and global variables of application
|   |   GUI.au3                # Entry point for graphic user interface (GUI)
|   |   SERVICES.au3           # Entry point for services applications
|   |      
|   +---business               # Folder for store all business annd logic code
|   |      
|   +---services               # Folder for store all services application 
|   |       Dialogbox.au3      # Handler of dialog box in which the user is prompted
|   |       ParametersIni.au3  # Handler of configuration file parameters.ini     
|   |       
|   \---views                  # Folder for store all views application
|           View_About.au3
|           View_Footer.au3
|           View_Settings.au3
|           View_Welcome.au3
|            
\---vendor                     # Third party code and dependencies handles with npm repository            
</code>
</pre>

<h2 id="r√©pertoires-et-fichiers-dun-projet-ags">R√©pertoires et fichiers d‚Äôun projet AGS</h2>

<p>On organise les fichiers d‚Äôun projet AGS dans des r√©pertoires sp√©cifiques.</p>

<h3 id="r√©pertoire-assets">R√©pertoire <code class="language-plaintext highlighter-rouge">assets</code></h3>

<p>Ce r√©pertoire contient tous les √©l√©ments utilis√©s dans l‚Äôapplication comme les images, les fichiers texte, pdf, html, css, javascript. Remarquons qu‚Äôil est possible d‚Äôint√©grer un fichier html statique dans une application AutoIt en utilisant un navigateur web int√©gr√© dans l‚Äôinterface graphique avec la m√©thode <code class="language-plaintext highlighter-rouge">_IECreateEmbedded()</code> fournie par la biblioth√®que <code class="language-plaintext highlighter-rouge">IE.au3</code>.</p>

<h3 id="r√©pertoire-bin">R√©pertoire <code class="language-plaintext highlighter-rouge">bin</code></h3>

<p>Ce r√©pertoire est utilis√© pour stocker tous les ex√©cutables du projet. L‚Äôapplication AGS-console en ligne de commande (CLI) est stock√©e dans ce dossier. Elle est construite dans l‚Äô√©cosyst√®me Node.js avec la biblioth√®que Caporal.js. Elle fournit des commandes pour aider les d√©veloppeurs, par exemple pour nettoyer tous les fichiers AutoIt du projet avec Tidy, poru cr√©er un installeur Windows, ou pour cr√©er rapidement un nouveau projet en choissisnant un mod√®le.</p>

<h3 id="r√©pertoire-config">R√©pertoire <code class="language-plaintext highlighter-rouge">config</code></h3>

<p>Un projet AGS doit avoir un fichier de configuration <code class="language-plaintext highlighter-rouge">./config/parameters.ini</code>.</p>

<p>Attention ce fichier n‚Äôest pas versionn√©, donc pour en cr√©er un nouveau vous pouvez utiliser <code class="language-plaintext highlighter-rouge">./config/parameters.ini.dist</code> comme un ‚Äòmod√®le‚Äô de ce √† quoi devrait ressembler votre fichier parameters.ini. D√©finissez les param√®tres ici qui peuvent √™tre diff√©rents sur chaque application. Pour utiliser ce fichier de configuration, nous utilisons la constante <code class="language-plaintext highlighter-rouge">$APP_PARAMETERS_INI</code> qui contient le chemin d‚Äôacc√®s complet. Cette constante est d√©finie dans <code class="language-plaintext highlighter-rouge">./src/GLOBALS.au3</code> et lors de chaque d√©marrage de l‚Äôapplication, AGS v√©rifie l‚Äôexistence du fichier de configuration.</p>

<h3 id="r√©pertoire-releases">R√©pertoire <code class="language-plaintext highlighter-rouge">releases</code></h3>

<p>Ce r√©pertorie contient le r√©sultat d‚Äôun bacth Windows qui contr√¥le la cr√©ation d‚Äôun installeur Windows via la solution <a href="http://www.jrsoftware.org/isinfo.php">InnoSetup</a> solution. Pour executer ce batch, il est n√©cessaire que le compilateur InnoSetup et 7zip soient install√©es sur le PC. Si ce n‚Äôest pas le cas, nous vous conseillons d‚Äôutilisteur le gestionnaire de paquets Windows <a href="https://chocolatey.org/">Chocolatey</a> pour les installer sans peine.</p>

<pre class="command-line" data-prompt="C: \&gt;">
<code class=" language-bash">choco install 7zip
choco install innosetup</code>
</pre>

<h3 id="r√©pertoire-src">R√©pertoire <code class="language-plaintext highlighter-rouge">src</code></h3>

<p>Tout le code source AutoiT de l‚Äôapplication est stock√© dans ce repertoire. Vous pouvez trouv√© des r√©pertoires sp√©cfiques dans ce dernier : services, views, ainsi que des fichiers sp√©cifiques : <code class="language-plaintext highlighter-rouge">GLOBALS.au3</code>, <code class="language-plaintext highlighter-rouge">GUI.au3</code> and <code class="language-plaintext highlighter-rouge">SERVICES.au3</code>.</p>

<h3 id="r√©pertoire-vendor">R√©pertoire <code class="language-plaintext highlighter-rouge">vendor</code></h3>

<p>Ce r√©pertoire est l‚Äôendroit par convention o√π stocker le code d√©velopp√© par des tiers.</p>

<p>Afin de simplifier la gestion des d√©pendances d‚Äôun projet AutoIt, nous utilisons yarn et le r√©f√©rentiel npmjs.org pour partager des biblioth√®ques AutoIt. Tous les paquets AGS h√©berg√©s dans ce r√©f√©rentiel npmjs appartiennent √† l‚Äôorganisation <a href="https://www.npmjs.com/search?q=autoit-gui-skeleton">@autoit-gui-skeleton</a>. Vous pouvez trouver deux types de package h√©b√©rg√©s dans cette organisation:</p>

<ul>
  <li>Un <strong>AGS-component</strong> est une biblioth√®que AutoIt cr√©√© sp√©cfiquement pour AGS. Vous pouvez l‚Äôutiliser plus facilement dans votre projet AutoIt construit avec le framework AGS. Pour l‚Äôexemple jetez un coup d‚Äô≈ìil sur <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-component-http-request">requ√™te http du composant AGS</a>.</li>
  <li>Un <strong>AGS-wrapper</strong> est une simple enveloppe pour une autre biblioth√®que AutoIt, cr√©√©e par une autre √©quipe/d√©veloppeur. Jetez un oeil √† cet exemple <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-wrapper-json">AGS-wrapper-json</a>
¬†
Pour installer toutes les d√©pendances d‚Äôun projet donn√© ; nous supposons que vous avez un <code class="language-plaintext highlighter-rouge">package.json</code> valide qui d√©crit votre projet et ses d√©pendences ; vous devez lancer la commande <code class="language-plaintext highlighter-rouge">Œª yarn install --modules-folder vendor</code>. Et ainsi toutes les d√©pendances de ce projet sont install√©es dans le r√©pertoire <code class="language-plaintext highlighter-rouge">./vendor/@autoit-gui-skeleton/</code>.</li>
</ul>

<h2 id="vue-densemble-de-larchitecture-dags">Vue d‚Äôensemble de l‚Äôarchitecture d‚ÄôAGS</h2>

<p><img src="https://autoit-gui-skeleton.github.io//assets/img/documentation/autoit-gui-skeleton_overview.png" alt="Vue d'ensemble de l'architecture d'AGS" class="img-fancybox img-full" /></p>

<h3 id="le-programme-dentr√©e-principal-myapplicationau3">Le programme d‚Äôentr√©e principal <code class="language-plaintext highlighter-rouge">MyApplication.au3</code></h3>

<p>C‚Äôest le point d‚Äôentr√©e unique de l‚Äôapplication, et l‚Äôemplacement o√π l‚Äôapplication d√©marre. Dans ce dernier, nous commen√ßons par inclure toutes les autres d√©pendances dont il a besoin : les biblioth√®ques d‚ÄôAutoIt, les biblioth√®ques tierces, la d√©claration des variables globales et le code pour l‚Äôinterface graphique et les services de l‚Äôapplication.</p>

<p>L‚Äôapplication d√©marre avec le gestionnaire principal de l‚ÄôIHM <code class="language-plaintext highlighter-rouge">_main_GUI()</code>.</p>

<h3 id="le-gestionnaire-principal-de-linterface-graphique-guiau3">Le gestionnaire principal de l‚Äôinterface graphique <code class="language-plaintext highlighter-rouge">GUI.au3</code></h3>

<p>Le fichier <code class="language-plaintext highlighter-rouge">./src/GUI.au3</code> est le point d‚Äôentr√©e de tous les gestionnaires de vues qui sont sauvegard√©s dans le r√©pertoire <code class="language-plaintext highlighter-rouge">./views</code>. Nous l‚Äôappellerons <strong>gestionnaire principal de l‚ÄôIHM</strong>. Le code de chaque vue est d√©fini √† chaque fois dans un fichier sp√©cifique et stock√© dans le r√©pertoire <code class="language-plaintext highlighter-rouge">./views</code>.</p>

<p>Le gestionnaire principal de l‚ÄôIHM contient la m√©thode <code class="language-plaintext highlighter-rouge">_main_GUI()</code> qui permet de d√©marrer l‚Äôapplication. Cette m√©thode n‚Äôest appell√©e que depuis le programme d‚Äôentr√©e principal de l‚Äôapplication, et elle a √©t√© con√ßue pour cr√©er l‚Äôinterface utilisateur (GUI) et g√©rer toutes les int√©ractions utilisateurs et les √©venements dans l‚Äôapplication.</p>

<h3 id="centralisez-la-d√©claration-des-variables-globales-avec-globalsau3">Centralisez la d√©claration des variables globales avec <code class="language-plaintext highlighter-rouge">GLOBALS.au3</code></h3>

<p>Toutes les constantes et les variables globales sont d√©finies √† un seul endroit dans le fichier <code class="language-plaintext highlighter-rouge">./src/GLOBALS.au3</code>, afin de centraliser la d√©claration de toutes les variables √† port√©e globale. √Ä l‚Äôexception de toutes les variables globales des √©l√©ments graphiques, qui eux, sont d√©finies dans chaque fichier de vue sp√©cifique. On rappelle que les constantes ne peuvent plus changer de valeur dans le temps, contrairement aux variables globales. Si une variable globale change de valeur, il n‚Äôest pas possible de persister son r√©sutlat, a moins de le faire dans le fichier de configuration <code class="language-plaintext highlighter-rouge">./config/parameters.ini</code></p>

<p>Par convention, toutes les variables globales doivent √™tre √©crites en majuscule et s√©par√©es par un trait de soulignement. Par exemple: <code class="language-plaintext highlighter-rouge">Global Const $ APP_EMAIL_CONTACT</code></p>

<h3 id="le-gestionnaire-principal-des-services-servicesau3">Le gestionnaire principal des services <code class="language-plaintext highlighter-rouge">SERVICES.au3</code></h3>

<p>Le fichier <code class="language-plaintext highlighter-rouge">./src/SERVICES.au3</code> est le point d‚Äôentr√©e de tous les services qui sont sauvegard√©s dans le r√©pertoire <code class="language-plaintext highlighter-rouge">./services</code>. Par exemple, dans AGS, nous avons toujours le service <code class="language-plaintext highlighter-rouge">ParametersIni.au3</code> qui fournit une m√©thode pour interargir avec le fichier de configuration de l‚Äôapplication. Il permet de sauvegarder les changements choisis par un utilisateur depuis l‚Äôinterface graphique.</p>

<h3 id="d√©ploiement-facile-avec-g√©n√©ration-dun-installateur-windows">D√©ploiement facile avec g√©n√©ration d‚Äôun installateur Windows</h3>

<p>Pour faciliter le d√©ploiement d‚Äôune application de bureau Windows d√©velopper avec AutoIt, AGS fournit un processus automatis√© pour g√©n√©rer un installeur Windows avec la solution <a href="http://www.jrsoftware.org/isinfo.php">InnoSetup</a>.</p>

<p>Pour g√©n√©rer un programme d‚Äôinstallation d‚Äôapplication AutoIt, voici les principales √©tapes √† suivre:</p>

<ul>
  <li>Attribuer un num√©ro de version √† l‚Äôapplication;</li>
  <li>Compilez l‚Äôapplication, c‚Äôest-√†-dire compilez le point d‚Äôentr√©e principal <code class="language-plaintext highlighter-rouge">myProject.au3</code> avec le compilateur <code class="language-plaintext highlighter-rouge">aut2exe</code>;</li>
  <li>Copier les assets (images, fichiers ‚Ä¶) n√©cessaires au bon fonctionnement de l‚Äôapplication dans le r√©pertoire de sortie;</li>
  <li>Cr√©er une archive zip pour packager l‚Äôapplication;</li>
  <li>Et finalement construire le programme d‚Äôinstallation en compilant le script InnoSetup associ√©.</li>
</ul>

<p>Toutes ces √©tapes sont pilot√©es par un batch Windows.</p>

<p><img src="https://autoit-gui-skeleton.github.io//assets/img/documentation/AGS-package-and-deployment-result.png" alt="Resultat du processus pour packager une application AutoIt dans AGS" class="img-fancybox" /></p>

<h2 id="gestion-de-d√©pendances-pour-autoit">Gestion de d√©pendances pour AutoIt</h2>

<p>Pour simplifier la gestion des d√©pendances d‚Äôun projet AutoIt construit avec AGS, nous avons d√©tourn√© de son usage initial le gestionnaire de d√©pendances npm, et son √©volution Yarn.</p>

<p>Ce qui nous permet de g√©rer les dependances d‚Äôun projet AGS avec d‚Äôautres librairies AutoIt, et de partager ces packages AutoIt depuis le dep√¥t npmjs.org. Nous supposons que vous avez d√©j√† install√© <a href="https://nodejs.org/">Node.js</a> et <a href="https://yarnpkg.com/lang/en/">Yarn</a>, par exemple avec [chocolatey] (https://chocolatey.org/) sur votre PC.</p>

<h3 id="ags-component-and-ags-wrapper">AGS-component and AGS-Wrapper</h3>

<p>Tous les paquets AGS h√©berg√©s dans le r√©ferentiel npmjs.org appartiennent √† l‚Äôorganisation <a href="https://www.npmjs.com/search?q=autoit-gui-skeleton">@autoit-gui-skeleton</a>. Et vous pouvez y trouver deux types de paquets h√©berg√©s dans cette organisation.</p>

<ul>
  <li>Un <strong>AGS-component</strong> est une biblioth√®que AutoIt, que vous pouvez utiliser facilement dans votre projet Autoit construit avec le framework AGS. Jetez un coup d‚Äô≈ìil √† ce composant <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-component-http-request">AGS-component http-request</a>.</li>
  <li>Un <strong>AGS-wrapper</strong> est une simple enveloppe d‚Äôune biblioth√®que AutoIt d√©velopp√© par un tiers. Ce qui permet de beneficier des avantages d‚Äôun gestionnaire de d√©pendances. Jetez un coup d‚Äô≈ìil √† cet exemple <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-wrapper-json">AGS-wrapper-json</a> qui encapsule le projet JSON.au3 con√ßu par Ward.</li>
</ul>

<p>Pour installer un composant AGS ou un wrapper dans son projet, il suffit de taper dans le repertoire racine, o√π le fichier <code class="language-plaintext highlighter-rouge">package.json</code> est stock√©:</p>

<pre class="command-line" data-prompt="C: \MyProject\&gt;">
<code class=" language-bash">yarn add @autoit-gui-skeleton/ags-component-xxx --modules-folder vendor
yarn add @autoit-gui-skeleton/ags-wrapper-xxx --modules-folder vendor</code>
</pre>

<h3 id="d√©crire-un-projet-ags-et-ses-d√©pendances">D√©crire un projet AGS et ses d√©pendances</h3>

<p>Pour d√©crire un projet AGS et ses dependances, on utilise naturellement le fichier <code class="language-plaintext highlighter-rouge">package.json</code> propre √† l‚Äô√©cosyst√®me Node.js. Vous pouvez trouvez plus d‚Äôinformation sur ce fichier ici <a href="https://yarnpkg.com/lang/en/docs/package-json/">https://yarnpkg.com/lang/en/docs/package-json/</a>.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="err">ApplicationWithCheckForUpdates</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example to implementation of AGS-component-check-for-updates"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"AGS"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"framework"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"AutoIt"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.3.14.5"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v20100v &lt;v20100v@no-reply.com&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MIT License"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"year"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"private"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"repository"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"not-yet-git"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"git"</span><span class="w">
  </span><span class="p">},</span><span class="w">  
  </span><span class="nl">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@autoit-gui-skeleton/AGS-component-check-for-updates"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Et finallement pour installer toutes les d√©pendances d‚Äôun projet donn√©, il suffit alors de lancer cette commande:</p>

<pre class="command-line" data-prompt="C: \&gt;MyProject\">
<code class=" language-bash">yarn install --modules-folder vendor</code>
</pre>

<p>Toutes les dependances du projet, ainsi que les d√©pendances filles des dependances m√®res, sont install√©s dans le r√©pertoire <code class="language-plaintext highlighter-rouge">./vendor/@autoit-gui-skeleton/</code>. Si vous avez ajouter des libraires AutoIt dans le repertoire vendor, nous vous conseillons de les ‚Äúwrapper‚Äù, afin qu‚Äôelles soient aussi g√©r√©s par le gestionnaire de d√©pendances, de la m√™me mani√®re qu‚Äôavec <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-wrapper-json">AGS-wrapper-json</a>.</p>

<p>Pour que les d√©pendances AutoIt s‚Äôinstallent dans le r√©pertoire <code class="language-plaintext highlighter-rouge">./vendor</code>, et pas dans le r√©pertoire par defaut de Node.js <code class="language-plaintext highlighter-rouge">./node_modules</code>, il faut ajouter l‚Äôoption <code class="language-plaintext highlighter-rouge">--modules-folder vendor</code>. Nous for√ßons ce choix pour √©viter toute confusion avec un projet Node.js. Remarquons qu‚Äôavec un projet AGS, il n‚Äôest pas n√©cessaire d‚Äô√©crire explicitement cet option en ligne de commande grace au fichier <code class="language-plaintext highlighter-rouge">.yarnrc</code> stock√© √† la racine du projet, i.e. au m√™me endroit que le fichier <code class="language-plaintext highlighter-rouge">package.json</code>. Yarn regarge automatiquement dans ce fichier pour ajouter une configuration d‚Äôoptions suppl√©mentaire.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code> #./.yarnrc 
 --modules-folder vendor
</code></pre></div></div>

<p>Ainsi avec ce fichier vous pouvez lancer <code class="language-plaintext highlighter-rouge">yarn install</code> pour installer les d√©pendances directement dans le r√©pertoire appropri√© <code class="language-plaintext highlighter-rouge">./vendor</code>.</p>

<h2 id="g√©rer-les-versions-de-lapplication">G√©rer les versions de l‚Äôapplication</h2>

<h3 id="contr√¥le-de-versions-avec-git">Contr√¥le de versions avec Git</h3>

<p>Dans le projet AGS, nous pr√©f√©rons utiliser Git pour le contr√¥le de version. Nous avons donc ajouter naturellement le fichier <code class="language-plaintext highlighter-rouge">.gitignore</code> √† la racine du projet AGS pour exclure certains fichiers. Il utilise des mod√®les de <em>globbing</em> pour faire correspondre les noms de fichiers. Vous pouvez trouver de l‚Äôaide pour le faire ici <a href="https://www.atlassian.com/git/tutorials/saving-changes/gitignore">https://www.atlassian.com/git/tutorials/saving-changes/gitignore</a> .</p>

<p>Si vous utilisez git, n‚Äôoubliez pas de d√©finir la propri√©t√© <code class="language-plaintext highlighter-rouge">repository</code> dans votre <code class="language-plaintext highlighter-rouge">./package.json</code>.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"repository"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://host.com/my-depot.git"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"git"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="v√©rifier-les-mises-√†-jours-de-lapplication">V√©rifier les mises √† jours de l‚Äôapplication</h3>

<p>On utilise un fichier json <code class="language-plaintext highlighter-rouge">RELEASES.json</code> en tant que r√©f√©rentiel pour tracer toutes les versions successives de l‚Äôapplication. Pour chaque version d√©crite, on trouve un lien pour t√©l√©charger cette version de l‚Äôapplication et un lien pour les notes de sortie associ√© √† cette version. Ce fichier est h√©berg√© sur un serveur distant, sans contrainte d‚Äôacc√®s.</p>

<p>Pour v√©rifier si une mise √† jour est disponible, il suffit alors de comparer la version <em>locale</em> de l‚Äôapplication install√© sur le PC, avec la derni√®re version stock√© dans ce r√©f√©rentiel JSON. Il est donc necessaire d‚Äôavoir une connexion internet.</p>

<p>Le fichier <code class="language-plaintext highlighter-rouge">RELEASES.json</code> doit respecter le schema suivant:</p>

<table>
  <thead>
    <tr>
      <th>Properties</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name</code></td>
      <td>Name of application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">description</code></td>
      <td>Short description of application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">license</code></td>
      <td>License of application.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">persistUrl</code></td>
      <td>URL where this file is persist on remote server.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">releases</code></td>
      <td>Collection of release schema.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">release.version</code></td>
      <td>Version of application use as an id.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">release.state</code></td>
      <td>More information of this version.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">release.downloadSetup</code></td>
      <td>URL where you can find the setup of this version.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">release.published</code></td>
      <td>Date of publication for this version (YYYY-mm-dd).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">release.releaseNotes</code></td>
      <td>URL where you can find the release note of this version.</td>
    </tr>
  </tbody>
</table>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyApplication"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example of RELEASES.json and implementation of AGS-component-check-for-updates"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MIT"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"homepage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://github.com/v20100v/autoit-gui-skeleton/"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"persistUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://myServer/myApplication/RELEASES.json"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"releases"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stable"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"downloadSetup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://myApplication.com/download/setup_myApplication_v1.0.0.exe"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"published"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-07"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"releaseNotes"</span><span class="p">:</span><span class="w"> </span><span class="err">ags-component-check-for-updates</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.9.0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stable"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"downloadSetup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://myApplication.com/download/setup_myApplication_v0.9.0.exe"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"published"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-07"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"releaseNotes"</span><span class="p">:</span><span class="w"> </span><span class="err">ags-component-check-for-updates</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.1.0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prototype"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"downloadSetup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"undefined"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"published"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-21"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"releaseNotes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"undefined"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Le fichier <code class="language-plaintext highlighter-rouge">RELEASES.json</code> est notamment utilis√© dans <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/AGS-component-check-for-updates">AGS-component check-updater</a>. Cette biblioth√®que fournit la fonction de mise √† jour d‚Äôune application AutoIt. Jetez un oeil √† cet exemple d‚Äôapplication AutoIt qui met en ≈ìuvre ce composant <a href="https://github.com/autoit-gui-skeleton/AGS-component-check-for-updates/tree/master/example/ApplicationWithCheckForUpdates">ApplicationWithCheckForUpdates</a>.<br />
 Cette application a les fonctionnalit√©s suivantes :</p>

<ul>
  <li>V√©rifier la mise √† jour au d√©marrage de l‚Äôapplication AutoIt;</li>
  <li>V√©rifier la mise √† jour depuis une int√©raction dans le menu ‚Äú?&gt; V√©rifier la mise √† jour‚Äù;</li>
  <li>Modifier les param√®tres de l‚Äôapplication √† partir de la vue ‚ÄúConfiguration &gt; Param√®tres‚Äù. Les valeurs modifi√©s sont persist√©s dans le fichier de configuration <code class="language-plaintext highlighter-rouge">./config/parameters.ini</code>. Dans cette vue, nous pouvons d√©finir des param√®tres proxy pour sp√©cifier comment cette application se connecte √† Internet, et envoie des requ√™tes HTTP.</li>
</ul>

<p>Si l‚Äôoption de v√©rification de la mise √† jour √† l‚Äôapplication de d√©marrage est activ√©e et qu‚Äôune nouvelle version de cette application est disponible, alors lorsque l‚Äôutilisateur d√©marre l‚Äôapplication ce composant informe l‚Äôutilisateur dans une fen√™tre enfant:</p>

<p><img src="https://raw.githubusercontent.com/autoit-gui-skeleton/ags-component-check-for-updates/master/example/ApplicationWithCheckForUpdates/docs/AGS-component-check-for-updates-update-available.png" alt="AGS-component-check-for-updates :: update available" /></p>

<h2 id="configurer-le-projet-ags">Configurer le projet AGS</h2>

<p>Pour configurer un projet AGS, nous avons:</p>

<ul>
  <li>Un fichier de configuration <code class="language-plaintext highlighter-rouge">./config/parameters.ini</code>, dont les valeurs des param√®tres peuvent √™tre modifi√©s par des utilisateurs.</li>
  <li>Les constantes et les variables globales sont d√©finies dans <code class="language-plaintext highlighter-rouge">./src/GLOBALS.au3</code>.</li>
</ul>

<h3 id="cr√©er-un-fichier-de-configuration">Cr√©er un fichier de configuration</h3>

<p>Lorsque vous d√©marrez un nouveau projet AGS, vous devez cr√©er ce fichier de configuration <code class="language-plaintext highlighter-rouge">./config/parameters.ini</code>. Ce fichier n‚Äôest pas versionn√©. Vous pouvez utiliser <code class="language-plaintext highlighter-rouge">./config/parameters.ini.dist</code> comme un ‚Äòmod√®le‚Äô de ce √† quoi devrait ressembler ce fichier. D√©finissez les param√®tres ici qui peuvent √™tre diff√©rents sur chaque application. Seul ce fichier est enregistr√© avec la version de contr√¥le.</p>

<p>La configuration des composants AGS se fait dans ce fichier. Par exemple avec <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/AGS-component-check-for-updates">AGS-component check-updater</a>, vous pouvez choisir avec le param√®tre <code class="language-plaintext highlighter-rouge">LAUNCH_CHECK_FOR_UPDATE_ON_STARTUP</code> si l‚Äôapplication doit v√©rifier √† chaque d√©marrage si une mise √† jour de l‚Äôapplication est disponible.</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[AGS_CHECK_FOR_UPDATES]</span>
<span class="c">; [REQUIRED] Enable/disable the search of a new update on start-up.
</span><span class="py">LAUNCH_CHECK_FOR_UPDATE_ON_STARTUP</span><span class="p">=</span><span class="s">1</span>
</code></pre></div></div>

<p>Pour un autre exemple avec le composant <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/ags-component-http-request">AGS-component http-request</a>, on peut configurer un proxy de la mani√®re suivante:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[AGS_HTTP_REQUEST]</span>
<span class="c">; [OPTIONAL] Use a proxy for http connexion
</span><span class="py">PROXY</span><span class="p">=</span><span class="s">http://myproxy.com:8080</span>
</code></pre></div></div>

<h3 id="constantes-et-variables-globales">Constantes et variables globales</h3>

<p>Toutes les constantes et les variables globales sont d√©finies √† un seul endroit <code class="language-plaintext highlighter-rouge">./src/GLOBALS.au3</code>, √† l‚Äôexception des variables globales des √©l√©ments graphiques, qui elles, sont d√©finies dans chaque fichier de vue sp√©cifique. N‚Äôoubliez pas que les constantes ne peuvent plus changer leur valeur au fil du temps, contrairement aux variables globales. Par convention, toutes les variables globales doivent √™tre √©crites en majuscules et s√©par√©es par un caract√®re de soulignement - par exemple: <code class="language-plaintext highlighter-rouge">Global Const $APP_EMAIL_CONTACT</code>.</p>

<p>Dans ce fichier de variables globales, on trouve notamment la section suivante des principales constantes de l‚Äôapplication:</p>

<pre><code class="language-autoit">;----------------------------;
; Application main constants ;
;----------------------------;
Global Const $APP_NAME = "ApplicationWithCheckForUpdates"
Global Const $APP_VERSION = "0.9.0"
Global Const $APP_WEBSITE = "https://myApplication-website.org"
Global Const $APP_EMAIL_CONTACT = "myApplication@website.org"
Global Const $APP_ID = "v20100v.ApplicationWithCheckForUpdates"
Global Const $APP_LIFE_PERIOD = "2018-" &amp; @YEAR
Global Const $APP_COPYRIGHT = "¬© " &amp; $APP_LIFE_PERIOD &amp; ", v20100v"
</code></pre>

<p>Avec le composant <a href="https://www.npmjs.com/package/@autoit-gui-skeleton/AGS-component-check-for-updates">AGS-component check-updater</a> nous d√©finissons la constante <code class="language-plaintext highlighter-rouge">$APP_REMOTE_RELEASES_JSON</code> pour sp√©cifier o√π le r√©f√©rentiel JSON est heberg√©. Ce fichier json doit √™tre persister dans un serveur distant disponible via internet, et sans restriction.</p>

<pre><code class="language-autoit">Global Const $APP_REMOTE_RELEASES_JSON = "https://myServer/myApplication/RELEASES.json"
</code></pre>

<p><br /></p>

<blockquote>
  <p><strong>Continuer la lecture ?</strong></p>

  <p><a href="https://autoit-gui-skeleton.github.io//fr/documentation/code-organization">2. Organisation du code d‚Äôun projet AGS</a>.</p>
</blockquote>
:ET